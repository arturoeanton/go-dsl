<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Comprobante - Motor Contable</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-container">
            <button class="menu-toggle" id="menuToggle">‚ò∞</button>
            <div class="navbar-brand">
                <h1>Motor Contable</h1>
            </div>
            <div class="navbar-actions">
                <div class="search-box">
                    <input type="text" placeholder="Buscar..." id="searchInput">
                    <button type="button" class="search-btn">üîç</button>
                </div>
                <div class="user-menu">
                    <img src="../img/avatar.png" alt="Usuario" class="user-avatar">
                    <span>Juan P√©rez</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </div>
            </div>
        </div>
    </nav>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="dashboard.html"><span class="menu-icon">üìä</span><span class="menu-text">Dashboard</span></a></li>
                    <li class="active"><a href="vouchers_list.html"><span class="menu-icon">üìÑ</span><span class="menu-text">Comprobantes</span></a></li>
                    <li><a href="journal_entries.html"><span class="menu-icon">üìö</span><span class="menu-text">Asientos</span></a></li>
                    <li><a href="accounts_chart.html"><span class="menu-icon">üè¶</span><span class="menu-text">Plan de Cuentas</span></a></li>
                    <li><a href="reports.html"><span class="menu-icon">üìà</span><span class="menu-text">Reportes</span></a></li>
                    <li><a href="dsl_editor.html"><span class="menu-icon">‚öôÔ∏è</span><span class="menu-text">Reglas DSL</span></a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <h2>Crear Comprobante</h2>
                <button class="btn btn-secondary" onclick="window.location.href='vouchers_list.html'">
                    ‚Üê Volver al Listado
                </button>
            </div>

            <!-- Form Content -->
            <form id="voucherForm">
                <!-- Basic Info Card -->
                <div class="card">
                    <div class="card-header">
                        <h3>üìÑ Informaci√≥n B√°sica</h3>
                    </div>
                    <div class="card-body">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="voucherType">Tipo de Comprobante *</label>
                                    <select id="voucherType" name="voucherType" class="form-control" required>
                                        <option value="">Seleccione...</option>
                                        <option value="invoice_sale">Factura de Venta</option>
                                        <option value="invoice_purchase">Factura de Compra</option>
                                        <option value="receipt">Recibo de Caja</option>
                                        <option value="payment">Comprobante de Egreso</option>
                                        <option value="debit_note">Nota D√©bito</option>
                                        <option value="credit_note">Nota Cr√©dito</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="reference">Referencia</label>
                                    <input type="text" id="reference" name="reference" 
                                           class="form-control" placeholder="REF-001-2024">
                                </div>

                                <div class="form-group">
                                    <label for="voucherDate">Fecha *</label>
                                    <input type="date" id="voucherDate" name="voucherDate" 
                                           class="form-control" value="2024-01-21" required>
                                </div>

                                <div class="form-group">
                                    <label for="currency">Moneda</label>
                                    <select id="currency" name="currency" class="form-control">
                                        <option value="COP">COP - Peso Colombiano</option>
                                        <option value="USD">USD - D√≥lar</option>
                                        <option value="EUR">EUR - Euro</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group full-width">
                                <label for="description">Descripci√≥n *</label>
                                <textarea id="description" name="description" rows="2" 
                                          class="form-control" placeholder="Descripci√≥n del comprobante..." required></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Customer/Supplier Info -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üë• Tercero</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-grid">
                                <div class="form-group full-width">
                                    <label for="thirdParty">Tercero Principal</label>
                                    <select id="thirdParty" name="thirdParty" class="form-control">
                                        <option value="">Sin tercero</option>
                                        <option value="TP001">Cliente Ejemplo S.A.S</option>
                                        <option value="TP002">Proveedor ABC Ltda</option>
                                        <option value="TP003">Empleado Juan P√©rez</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Accounting Lines -->
                    <div class="card">
                        <div class="card-header">
                            <h3>üìã L√≠neas Contables</h3>
                            <button type="button" class="btn btn-primary btn-sm" id="addLineBtn">
                                ‚ûï Agregar L√≠nea
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th style="width: 25%">Cuenta</th>
                                            <th style="width: 30%">Descripci√≥n</th>
                                            <th style="width: 15%">D√©bito</th>
                                            <th style="width: 15%">Cr√©dito</th>
                                            <th style="width: 10%">Tercero</th>
                                            <th style="width: 5%">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="voucherLines">
                                        <!-- Lines will be added dynamically -->
                                    </tbody>
                                    <tfoot>
                                        <tr class="table-footer">
                                            <td colspan="2" class="text-right"><strong>Totales:</strong></td>
                                            <td class="text-right"><strong id="totalDebit">$ 0</strong></td>
                                            <td class="text-right"><strong id="totalCredit">$ 0</strong></td>
                                            <td colspan="2"></td>
                                        </tr>
                                        <tr>
                                            <td colspan="2" class="text-right">Diferencia:</td>
                                            <td colspan="2" class="text-center">
                                                <span id="difference">$ 0</span>
                                                <span id="balanceStatus" class="balance-status">‚öñÔ∏è Sin movimientos</span>
                                            </td>
                                            <td colspan="2"></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                    </div>

                    <!-- Actions -->
                    <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                            üíæ Guardar Borrador
                        </button>
                        <button type="submit" class="btn btn-primary">
                            ‚úÖ Crear y Procesar
                        </button>
                    </div>
                </form>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/api_service.js"></script>
    <script src="js/voucher_form.js"></script>
</body>
</html>