<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Comprobantes - Motor Contable</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-container">
            <button class="menu-toggle" id="menuToggle">‚ò∞</button>
            <div class="navbar-brand">
                <h1>Motor Contable</h1>
            </div>
            <div class="navbar-actions">
                <div class="search-box">
                    <input type="text" placeholder="Buscar comprobantes..." id="searchInput">
                    <button type="button" class="search-btn">üîç</button>
                </div>
                <div class="user-menu">
                    <img src="../img/avatar.png" alt="Usuario" class="user-avatar">
                    <span>Juan P√©rez</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </div>
            </div>
        </div>
    </nav>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="dashboard.html"><span class="menu-icon">üìä</span><span class="menu-text">Dashboard</span></a></li>
                    <li class="active"><a href="vouchers_list.html"><span class="menu-icon">üìÑ</span><span class="menu-text">Comprobantes</span></a></li>
                    <li><a href="journal_entries.html"><span class="menu-icon">üìö</span><span class="menu-text">Asientos</span></a></li>
                    <li><a href="accounts_chart.html"><span class="menu-icon">üè¶</span><span class="menu-text">Plan de Cuentas</span></a></li>
                    <li><a href="reports.html"><span class="menu-icon">üìà</span><span class="menu-text">Reportes</span></a></li>
                    <li><a href="dsl_editor.html"><span class="menu-icon">‚öôÔ∏è</span><span class="menu-text">Reglas DSL</span></a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <h2>Lista de Comprobantes</h2>
                <button class="btn btn-primary" onclick="window.location.href='vouchers_form.html'">
                    ‚ûï Nuevo Comprobante
                </button>
            </div>

            <!-- Filters Section -->
            <div class="card filters-card">
                <div class="card-header">
                    <h3>üîç Filtros</h3>
                    <button class="btn btn-secondary btn-sm" id="toggleFilters">Mostrar/Ocultar</button>
                </div>
                <div class="card-body filters-body" id="filtersBody">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label>Fecha Desde</label>
                            <input type="date" class="form-control" id="dateFrom" value="2024-01-01">
                        </div>
                        <div class="filter-group">
                            <label>Fecha Hasta</label>
                            <input type="date" class="form-control" id="dateTo" value="2024-01-31">
                        </div>
                        <div class="filter-group">
                            <label>Tipo de Comprobante</label>
                            <select class="form-control" id="voucherType">
                                <option value="">Todos</option>
                                <option value="invoice_sale">Factura de Venta</option>
                                <option value="invoice_purchase">Factura de Compra</option>
                                <option value="payment">Pago</option>
                                <option value="receipt">Recibo</option>
                                <option value="credit_note">Nota Cr√©dito</option>
                                <option value="debit_note">Nota D√©bito</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Estado</label>
                            <select class="form-control" id="voucherStatus">
                                <option value="">Todos</option>
                                <option value="DRAFT">Borrador</option>
                                <option value="PENDING">Pendiente</option>
                                <option value="PROCESSING">Procesando</option>
                                <option value="PROCESSED">Procesado</option>
                                <option value="ERROR">Error</option>
                                <option value="CANCELLED">Anulado</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Tercero</label>
                            <input type="text" class="form-control" id="thirdParty" placeholder="Nombre o NIT">
                        </div>
                        <div class="filter-group">
                            <label>Monto Desde</label>
                            <input type="number" class="form-control" id="amountFrom" placeholder="0">
                        </div>
                        <div class="filter-group">
                            <label>Monto Hasta</label>
                            <input type="number" class="form-control" id="amountTo" placeholder="999999999">
                        </div>
                        <div class="filter-group">
                            <label>&nbsp;</label>
                            <button class="btn btn-primary btn-block" onclick="applyFilters()">
                                üîç Aplicar Filtros
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions Bar -->
            <div class="actions-bar">
                <div class="bulk-actions">
                    <label class="checkbox-container">
                        <input type="checkbox" id="selectAll">
                        <span class="checkmark"></span>
                        Seleccionar Todo
                    </label>
                    <button class="btn btn-secondary btn-sm" disabled id="bulkProcess">
                        ‚ö° Procesar Seleccionados
                    </button>
                    <button class="btn btn-secondary btn-sm" disabled id="bulkExport">
                        üì• Exportar Seleccionados
                    </button>
                    <button class="btn btn-danger btn-sm" disabled id="bulkDelete">
                        üóëÔ∏è Eliminar Seleccionados
                    </button>
                </div>
                <div class="view-options">
                    <label>Mostrar:</label>
                    <select class="form-control form-control-sm" id="pageSize">
                        <option value="20">20</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                    </select>
                    <button class="btn btn-secondary btn-sm" title="Vista de tabla">üìã</button>
                    <button class="btn btn-secondary btn-sm" title="Vista de tarjetas">üìá</button>
                </div>
            </div>

            <!-- Vouchers Table -->
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table data-table" id="vouchersTable">
                            <thead>
                                <tr>
                                    <th width="30">
                                        <input type="checkbox" class="select-all-header">
                                    </th>
                                    <th>N√∫mero</th>
                                    <th>Fecha</th>
                                    <th>Tipo</th>
                                    <th>Tercero</th>
                                    <th>Descripci√≥n</th>
                                    <th>Monto</th>
                                    <th>Estado</th>
                                    <th width="120">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="vouchersTableBody">
                                <!-- Data will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <div class="pagination-container">
                        <div class="pagination-info">
                            Mostrando <span id="showingFrom">1</span> - <span id="showingTo">50</span> 
                            de <span id="totalRecords">0</span> comprobantes
                        </div>
                        <div class="pagination">
                            <button class="btn btn-sm" id="prevPage" disabled>‚óÄ Anterior</button>
                            <span class="page-numbers" id="pageNumbers"></span>
                            <button class="btn btn-sm" id="nextPage">Siguiente ‚ñ∂</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="stats-bar">
                <div class="stat-item">
                    <span class="stat-label">Total Comprobantes:</span>
                    <span class="stat-value" id="totalVouchers">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Monto Total:</span>
                    <span class="stat-value" id="totalAmount">$0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Pendientes:</span>
                    <span class="stat-value text-warning" id="pendingCount">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Con Errores:</span>
                    <span class="stat-value text-danger" id="errorCount">0</span>
                </div>
            </div>
        </main>
    </div>

    <!-- Quick View Modal -->
    <div class="modal" id="quickViewModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3>Vista R√°pida del Comprobante</h3>
                <button class="close-modal" onclick="closeQuickView()">&times;</button>
            </div>
            <div class="modal-body" id="quickViewContent">
                <!-- Quick view content will be loaded here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeQuickView()">Cerrar</button>
                <button class="btn btn-primary" id="editFromQuickView">Editar</button>
                <button class="btn btn-success" id="processFromQuickView">Procesar</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p>Cargando comprobantes...</p>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/api_service.js"></script>
    <script src="js/vouchers_list.js"></script>
</body>
</html>